import{u as w}from"./store-11a387d4.js";import{d as D,b as y,r as E,v as F,o as $,f as j,g as n,h as r,j as e,t as d,a as u,F as M,x as C,k as _,u as h,y as O,s as A,n as B}from"./index-2625a230.js";const S={class:"flex gap-4 max-h-400px"},U={class:"w-full relative rounded-lg sh"},Z={class:"col center m-8"},z={class:"grid3 p-8 gap-8"},I={class:"row gap-4"},L={class:"text-sm text-body"},T={class:"text-sm text-body"},N={class:"text-sm text-body"},R={class:"text-sm text-body"},V={class:"col center p-8"},G={key:0},K=["href"],P=["src"],q={key:1},H=["src"],J=["href"],Q={key:2},W=["href"],X=["src"],Y={key:3},ee=["href"],se=D({__name:"MessageUpload",setup(g){const l=y([]),c=y([]),{state:i}=w(),p=async()=>{const{data:t}=await h(`/api/upload?user=${i.user.ref}`,{method:"GET"}).json();u(t).forEach(a=>{c.push(a)})},m=async t=>{!t||t.length===0||(t.map(o=>{const a=O(o);return{user:i.user.ref,name:o.name,key:i.user.ref,url:a.value,type:o.type,lastModified:o.lastModified,file:o}}).forEach(async o=>{l.push(o);const a=new FormData;a.append("file",o.file);const{data:s}=await h(`/api/upload?key=${o.key}&size=${o.file.size}&user=${o.user}`,{method:"POST",body:a}).json();c.push(u(s))}),await p())},f=E(),{isOverDropZone:x}=F(f,m),v=()=>{const t=document.createElement("input");t.onchange=o=>{const a=o.target.files;m(Array.from(a))},t.setAttribute("type","file"),t.setAttribute("multiple","true"),t.setAttribute("accept","*/*"),t.click()},k=async t=>{await h(`/api/upload?ref=${t.ref}`,{method:"DELETE"}).json(),l.splice(l.indexOf(t),1),c.splice(c.indexOf(t),1),await p(),i.notifications.push({status:"success",message:"File deleted"})};return $(async()=>{i.user&&await p()}),(t,o)=>{const a=j("Icon");return n(),r("div",S,[e("div",U,[e("div",{ref_key:"dropZoneRef",ref:f,onClick:v,multiple:"",class:"flex flex-col w-full min-h-200px h-auto bg-gray-400/10 justify-center items-center mt-6"},[e("div",null,d(u(x)?"Drop here":"Drag and drop files here"),1)],512),e("div",Z,[e("div",z,[(n(!0),r(M,null,C(u(c),(s,b)=>(n(),r("div",{key:b,class:"col bg-gray-100 sh center gap-2 p-4"},[e("p",I,[_(a,{icon:"mdi-close",onClick:ae=>k(s),class:"x2 cp hover:red-700 text-red-500 scale"},null,8,["onClick"])]),e("p",L,d(s.name),1),e("p",T,d((s.size/1e3).toFixed(2))+" Kb ",1),e("p",N,d(s.type),1),e("p",R,d(new Date(s.lastModified).toLocaleString()),1),e("div",V,[s.type.includes("image")?(n(),r("div",G,[e("a",{href:s.url,target:"_blank"},[e("img",{src:s.url},null,8,P)],8,K)])):s.type.includes("video")?(n(),r("div",q,[e("video",{controls:"",src:s.url},null,8,H),e("a",{href:s.url,target:"_blank"},[_(a,{icon:"mdi-video",class:"x4"})],8,J)])):s.type.includes("audio")?(n(),r("div",Q,[e("a",{href:s.url,target:"_blank"},[_(a,{icon:"mdi-music",class:"x4"})],8,W),e("audio",{controls:"",src:s.url},null,8,X)])):(n(),r("div",Y,[e("a",{href:s.url,target:"_blank"},[_(a,{icon:"mdi-file",class:"x4"})],8,ee)]))])]))),128))])])])])}}}),te={};function oe(g,l){const c=se;return n(),B(c)}const re=A(te,[["render",oe]]);export{re as default};
